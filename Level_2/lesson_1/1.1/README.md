# Прогнозирование временного ряда покупок с помощью H2O AutoML

Проект посвящён задаче прогнозирования суммы покупок на основе временного ряда с использованием автоматизированного машинного обучения (H2O AutoML). В ноутбуке реализован полный цикл: загрузка и анализ данных, генерация признаков, визуализация, декомпозиция, обучение, оценка и анализ ошибок.

---

## Краткие тезисы
- **Цель:** Прогнозирование суммы покупок по временным данным с помощью H2O AutoML.
- **Данные:** .CSV-файл с транзакциями, датой, демографией, категорией товара и рейтингом.
- **Признаки:** Признаки: Лаги, скользящие средние, сезонные признаки (месяц, день недели).
- **Модель:** Автоматический подбор лучших моделей (deeplearning, ансамбли, GBM и др.).
- **Метрики:** MSE, MAE, MAPE, R².
- **Результаты:** RMSE: ~77, MAE: ~64, MAPE: ~2.8%,R²: ~0.9998.Высокая точность, остатки случайны, модель устойчива.
- **Выводы:** Подход работает, но есть куда расти (добавить внешние признаки, протестировать на новых данных, попробовать другие типы признаков.).

---

## Описание данных

- **Источник:** [Practice Dataset: Sales & Customer Data (500 Rows)](https://www.kaggle.com/datasets/zuhairkhan13/practice-dataset-sales-and-customer-data-500-rows)
- **Формат:** csv
- **Структура:**
 - ID — идентификатор
 - Join_Date — дата транзакции (временной индекс)
 - Purchase_Amount — сумма покупки (целевой признак)
 - Дополнительно: имя, возраст, пол, страна, категория товара, рейтинг
## Этапы пайплайна

1. **Загрузка и предобработка**
   - Чтение данных, преобразование даты, сортировка.
   - Удаление пропусков, формирование временного ряда.
2. **Визуализация**
   - График временного ряда, декомпозиция на тренд/сезонность/остатки.
3. **Генерация признаков**
   - Лаги (1–10), скользящие средние (3, 7), месяц, день недели.
4. **Обучение (H2O AutoML)**
   - Автоматический перебор моделей, подбор гиперпараметров.
5. **Оценка качества**
   - RMSE, MAE, MAPE, R² —  модель объясняет почти всю дисперсию.
6. **Анализ остатков**
   - Остатки случайны, автокорреляции нет, переобучения не наблюдается.
7. **Анализ ошибок**
   - Абсолютные значения ошибок лежат в диапазоне примерно 120–193, что на фоне общего разброса целевой переменной (до 20 000) — не критично.

## Метрики
- **RMSE (Root Mean Squared Error)** — Среднее квадратичное отклонение между предсказанными и реальными значениями.
- **MAE (Mean Absolute Error)** — Средняя абсолютная ошибка.
- **MAPE (Mean Absolute Percentage Error)** — Средняя абсолютная процентная ошибка.
- **R² (коэффициент детерминации)** — Объяснение дисперсии целевой переменной моделью.

## Результаты
- **RMSE**: ~77
- **MAE**: ~64
- **MAPE**: ~2.8%
- **R²**: ~0.9998


### Требования
- Python 3.10+
- Установить зависимости:

```bash
pip install -r requirements.txt
```
