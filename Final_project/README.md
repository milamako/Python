# Финальный проект: Прогнозирование стоимости косметики.

 Проект посвящен решению задачи регрессии и предоставляет полный цикл анализа данных — от загрузки и предобработки данных до создания и оценки моделей машинного обучения. Он включает модули для разведочного анализа данных, инженерии признаков, выбора признаков, обнаружения аномалий и визуализации результатов.

## Описание проекта

### Модули проекта:


**`data_loader.py`**
    Модуль для загрузки данных из файлов CSV и Excel:
        Класс DataLoader для загрузки данных.
        Поддержка различных форматов файлов.
        Обработка ошибок при чтении файлов.
        
**`data_analysis.py`**
    Модуль для анализа данных, включая функции для:
        Подсчета пропущенных значений.
        Определения типов данных.
        Описания датасета и генерации отчета.
        Вывода основной статистики по данным.

**`eda.py`**
    Модуль для выполнения разведочного анализа данных (Exploratory Data Analysis):
        Визуализация распределений признаков (гистограммы, ящики с усами).
        Анализ зависимостей между признаками (диаграммы рассеяния, парные графики).
        Построение корреляционной матрицы и ее визуализация.
        Выявление выбросов и аномалий.

**`preprocessing.py`**
    Модуль для предобработки данных:
        Обработка пропущенных значений.
        Кодирование категориальных признаков (Label Encoding, One-Hot Encoding).
        Масштабирование числовых признаков.
        Разделение данных на обучающую и тестовую выборки.

**`feature_engineering.py`**
    Модуль для создания новых признаков и преобразования существующих для улучшения моделей.

**`feature_selection.py`**
    Модуль для отбора наиболее значимых признаков с использованием методов:
        Статистического тестирования.
        Встроенных методов моделей (feature importances).
        Рекурсивного исключения признаков (RFE).

**`modeling.py`**
    Модуль для обучения и оценки моделей машинного обучения:
        Определение и настройка моделей.
        Подбор гиперпараметров с использованием GridSearchCV.
        Оценка моделей с использованием метрик (MAE, MSE, RMSE, R² Score).

**`anomaly_detection.py`**
    Модуль для обнаружения выбросов и аномалий:
        Алгоритмы, такие как Isolation Forest или другие модели для выявления аномалий.
        Методы анализа остатков моделей.

**`visualization.py`**
    Модуль для визуализации результатов моделей:
        Построение графиков фактических vs предсказанных значений.
        Визуализация ошибок прогнозирования.
        Графики важности признаков.
        Графики метрик качества моделей.

### Описание данных

Ссылка на датасет: https://www.kaggle.com/datasets/waqi786/most-used-beauty-cosmetics-products-in-the-world

Датасет состоит из **15,000** строк и **14** столбцов. Ниже приведено описание каждого столбца:

- **Product_Name** (object): Название косметического продукта.
- **Brand** (object): Бренд или производитель продукта.
- **Category** (object): Категория продукта (например, помада, крем и т.д.).
- **Usage_Frequency** (object): Частота использования продукта (Daily, Weekly, Monthly, Occasional).
- **Price_USD** (float64): Цена продукта в долларах США.
- **Rating** (float64): Рейтинг продукта (от 1 до 5).
- **Number_of_Reviews** (int64): Количество отзывов о продукте.
- **Product_Size** (object): Размер продукта (например, 30ml, 50ml).
- **Skin_Type** (object): Тип кожи, для которой предназначен продукт (Dry, Oily, Combination, Sensitive, Normal).
- **Gender_Target** (object): Целевая аудитория по гендеру (Female, Male, Unisex).
- **Packaging_Type** (object): Тип упаковки продукта (Bottle, Tube, Jar, Stick, Compact, Spray).
- **Main_Ingredient** (object): Основной ингредиент продукта (Retinol, Vitamin C, Aloe Vera и т.д.).
- **Cruelty_Free** (bool): Признак того, что продукт не тестируется на животных (True или False).
- **Country_of_Origin** (object): Страна происхождения продукта.

### Используемые алгоритмы

Модуль поддерживает обучение моделей с использованием следующих алгоритмов:

- DummyRegressor
- AdaBoostRegressor
- HuberRegressor
- Lasso
- LassoLars

Ансамблевые методы:

- VotingRegressor
- StackingRegressor

Модели обучаются с использованием подбора гиперпараметров `GridSearchCV`, а также выполняется отбор признаков с использованием `SelectKBest`.


## Результаты

Наилучшие результаты показала модель `AdaBoostRegressor` — **R² Score: 0.5010**. Модель `StackingRegressor` также показала повышенную точность — **R2 Score: 0.4307**.


## Установка и запуск

### Требования

- Python 3.12
- Необходимые библиотеки можно установить с помощью `pip`:

```bash
pip install -r requirements.txt
